{
    "probe_model": "Sonata_Transformer_Specialist",
    "best_score_during_search": 0.715785190683204,
    "best_feature_plan": [
        [
            {
                "function": "delete_features",
                "args": {
                    "cols": [
                        "is_weekend"
                    ]
                }
            }
        ]
    ],
    "final_features": [
        "dayofweek",
        "month",
        "weekofyear",
        "year",
        "day",
        "temp_lag_1",
        "temp_lag_2",
        "temp_lag_3",
        "temp_lag_7",
        "temp_lag_14",
        "temp_rolling_mean_7",
        "temp_rolling_std_7",
        "temp_rolling_min_7",
        "temp_rolling_max_7",
        "temp_rolling_mean_14",
        "temp_rolling_std_14",
        "temp_rolling_min_14",
        "temp_rolling_max_14",
        "temp_rolling_mean_30",
        "temp_rolling_std_30",
        "temp_rolling_min_30",
        "temp_rolling_max_30"
    ],
    "final_validation_scores": {
        "LightGBM": {
            "r2": 0.715785190683204,
            "mae": 1.7078904226366483,
            "rmse": 2.187808475149122
        },
        "SimpleNN": {
            "r2": 0.7108119430731974,
            "mae": 1.7328574743662795,
            "rmse": 2.206866820281347
        },
        "EnhancedNN": {
            "r2": 0.7130586509361023,
            "mae": 1.7213172079765633,
            "rmse": 2.198277508639365
        },
        "Transformer": {
            "r2": 0.714877992363678,
            "mae": 1.724148647099325,
            "rmse": 2.191297376510373
        }
    },
    "best_final_model": {
        "name": "LightGBM",
        "metrics": {
            "r2": 0.715785190683204,
            "mae": 1.7078904226366483,
            "rmse": 2.187808475149122
        }
    },
    "run_history": [
        {
            "iteration": 0,
            "plan": "Baseline",
            "feature_name": "Baseline",
            "performance": 0.590635833416004,
            "adopted": true,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend"
            ],
            "importances": "      feature  importance\n0  weekofyear        1713\n1   dayofweek         932\n2       month         355\n3  is_weekend           0"
        },
        {
            "iteration": "Baseline+",
            "plan": "{'function': 'create_control_baseline_features', 'args': {'col': 'temp'}}",
            "feature_name": "control_baseline_features_set",
            "performance": 0.715785190683204,
            "adopted": true,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 1,
            "plan": "[{'function': 'create_fourier_features', 'args': {'col': 'date', 'order': 2}}, {'function': 'create_interaction_features', 'args': {'col1': 'is_weekend', 'col2': 'temp_lag_1'}}]",
            "feature_name": "fourier_features_order_2, is_weekend_x_temp_lag_1",
            "performance": 0.7094149171762498,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 2,
            "plan": "[{'function': 'create_lag_features', 'args': {'col': 'temp', 'lags': [28]}}, {'function': 'create_rolling_features', 'args': {'col': 'temp', 'windows': [60], 'aggs': ['mean']}}]",
            "feature_name": "temp_lag_28, temp_rolling_mean_60",
            "performance": 0.7123020123365007,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 3,
            "plan": "[{'function': 'create_embedding_features', 'args': {'col': 'date', 'window_size': 365}}, {'function': 'create_lag_features', 'args': {'col': 'temp', 'lags': [365]}}, {'function': 'create_interaction_features', 'args': {'col1': 'month', 'col2': 'temp_lag_1'}}]",
            "feature_name": "embed_0_win365, temp_lag_365, month_x_temp_lag_1",
            "performance": 0.696219310181907,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 4,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_lag_features', 'args': {'col': 'temp', 'lags': [21]}}, {'function': 'create_interaction_features', 'args': {'col1': 'weekofyear', 'col2': 'temp_lag_1'}}]",
            "feature_name": "deleted_1_features, temp_lag_21, weekofyear_x_temp_lag_1",
            "performance": 0.7145159124529876,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 5,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_lag_features', 'args': {'col': 'temp', 'lags': [4, 5, 6]}}]",
            "feature_name": "deleted_1_features, temp_lag_6",
            "performance": 0.7068770737870389,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 6,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_embedding_features', 'args': {'col': 'date', 'window_size': 90}}]",
            "feature_name": "deleted_1_features, embed_0_win90",
            "performance": 0.7039479840957383,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 7,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_embedding_features', 'args': {'col': 'date', 'window_size': 730}}]",
            "feature_name": "deleted_1_features, embed_0_win730",
            "performance": 0.7033036702960611,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 8,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_fourier_features', 'args': {'col': 'date', 'order': 3}}]",
            "feature_name": "deleted_1_features, fourier_features_order_3",
            "performance": 0.6994948005019018,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 9,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}, {'function': 'create_interaction_features', 'args': {'col1': 'dayofweek', 'col2': 'temp_rolling_std_7'}}]",
            "feature_name": "deleted_1_features, dayofweek_x_temp_rolling_std_7",
            "performance": 0.7102243419094632,
            "adopted": false,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "is_weekend",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45\n22            is_weekend           0"
        },
        {
            "iteration": 10,
            "plan": "[{'function': 'delete_features', 'args': {'cols': ['is_weekend']}}]",
            "feature_name": "deleted_1_features",
            "performance": 0.715785190683204,
            "adopted": true,
            "available_features": [
                "dayofweek",
                "month",
                "weekofyear",
                "year",
                "day",
                "temp_lag_1",
                "temp_lag_2",
                "temp_lag_3",
                "temp_lag_7",
                "temp_lag_14",
                "temp_rolling_mean_7",
                "temp_rolling_std_7",
                "temp_rolling_min_7",
                "temp_rolling_max_7",
                "temp_rolling_mean_14",
                "temp_rolling_std_14",
                "temp_rolling_min_14",
                "temp_rolling_max_14",
                "temp_rolling_mean_30",
                "temp_rolling_std_30",
                "temp_rolling_min_30",
                "temp_rolling_max_30"
            ],
            "importances": "                 feature  importance\n0             temp_lag_1         272\n1             temp_lag_2         246\n2            temp_lag_14         236\n3             temp_lag_3         183\n4     temp_rolling_std_7         173\n5    temp_rolling_mean_7         170\n6    temp_rolling_std_30         161\n7             temp_lag_7         161\n8    temp_rolling_std_14         136\n9    temp_rolling_max_14         130\n10            weekofyear         118\n11  temp_rolling_mean_14         116\n12                   day         114\n13  temp_rolling_mean_30         111\n14   temp_rolling_max_30         109\n15    temp_rolling_max_7         109\n16    temp_rolling_min_7         102\n17   temp_rolling_min_14          85\n18             dayofweek          85\n19   temp_rolling_min_30          83\n20                  year          55\n21                 month          45"
        }
    ]
}